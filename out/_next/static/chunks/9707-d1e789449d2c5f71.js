"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9707],{54465:function(e,n,t){t.d(n,{J:function(){return u}});var i="https://js.stripe.com/v3",r=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,s="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",o=null,l=function(e){return null!==o||(o=new Promise((function(n,t){if("undefined"!==typeof window)if(window.Stripe&&e&&console.warn(s),window.Stripe)n(window.Stripe);else try{var o=function(){for(var e=document.querySelectorAll('script[src^="'.concat(i,'"]')),n=0;n<e.length;n++){var t=e[n];if(r.test(t.src))return t}return null}();o&&e?console.warn(s):o||(o=function(e){var n=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",t=document.createElement("script");t.src="".concat(i).concat(n);var r=document.head||document.body;if(!r)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return r.appendChild(t),t}(e)),o.addEventListener("load",(function(){window.Stripe?n(window.Stripe):t(new Error("Stripe.js not available"))})),o.addEventListener("error",(function(){t(new Error("Failed to load Stripe.js"))}))}catch(l){return void t(l)}else n(null)}))),o},a=function(e,n,t){if(null===e)return null;var i=e.apply(void 0,n);return function(e,n){e&&e._registerWrapper&&e._registerWrapper({name:"stripe-js",version:"1.45.0",startTime:n})}(i,t),i},d=Promise.resolve().then((function(){return l(null)})),c=!1;d.catch((function(e){c||console.warn(e)}));var u=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];c=!0;var i=Date.now();return d.then((function(e){return a(e,n,i)}))}},56001:function(e,n,t){t.d(n,{K:function(){return i},b:function(){return r}});var i="Gifty",r="pk_test_51KLNAfBiwDSxURARdoxGugM3IDVl4gb67C8iUq8jFLCbnVpQeL6U3zf8PSLlmCOq2rROe3m2fgjj4bBr7cYSd2tV00Ca6RiYKa"},30622:function(e,n,t){var i=t(85893);n.Z=function(e){var n=e.onClick,t=void 0===n?function(){}:n,r=e.onChange,s=e.name,o=e.value,l=e.type,a=void 0===l?"text":l,d=e.label,c=e.placeholder,u=e.className,m=void 0===u?"":u,p=e.className2,h=void 0===p?"":p,v=e.className3,f=void 0===v?"":v,b=e.className4,x=void 0===b?"":b,y=e.is_readonly,g=void 0!==y&&y,_=e.no_label,j=void 0!==_&&_,w=e.icon,N=void 0===w?null:w,S=e.pipe,C=void 0!==S&&S,k=e.textarea,P=void 0!==k&&k,O=e.rows,A=void 0===O?3:O,E=e.cols,L=void 0===E?15:E,B=e.required,q=void 0!==B&&B,F=e.minLength,I=void 0===F?0:F,D=e.maxLength,V=void 0===D?null:D,R=e.autoFocus,T=void 0!==R&&R;return(0,i.jsxs)("div",{className:"".concat(""!==m?m:"mb-5"),children:[!j&&(0,i.jsx)("div",{className:"text-gray-600 mb-2",children:d}),(0,i.jsxs)("div",{className:"".concat(h," ").concat(N&&"relative flex justify-center items-center"),children:[!P&&(0,i.jsx)("input",{required:q,onClick:t,onChange:r,type:a,name:s,value:o&&o,className:"bg-cWhite border px-5 py-3 w-full outline-none rounded-md ".concat(f," focus:shadow-c6 focus:outline-none focus:border-cBrand "),placeholder:c,readOnly:g,minLength:I,autoFocus:T,maxLength:V}),P&&(0,i.jsx)("textarea",{name:s,required:q,onChange:r,value:o,className:"h-full w-full resize-none rounded-md outline-none px-5 py-3 border ".concat(f," focus:shadow-c6 focus:outline-none focus:border-cBrand"),rows:A,cols:L,placeholder:c,minLength:I,maxLength:V,autoFocus:T}),N&&(0,i.jsx)("div",{className:"absolute right-1 px-2 ".concat(C&&"border-l"," border-gray-300 text-gray-600 ").concat(x),children:N})]})]})}},29707:function(e,n,t){t.r(n);var i=t(34051),r=t.n(i),s=t(85893),o=t(67294),l=t(34036),a=t(35832),d=t(11163),c=t(74995),u=t(54465),m=t(86664),p=t(83782),h=t(56001),v=t(31567);function f(e,n,t,i,r,s,o){try{var l=e[s](o),a=l.value}catch(d){return void t(d)}l.done?n(a):Promise.resolve(a).then(i,r)}function b(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function x(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},i=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),i.forEach((function(n){b(e,n,t[n])}))}return e}var y=(0,u.J)(h.b);n.default=function(e){var n,t,i=e.changeState,u=(0,o.useState)(!1),h=(u[0],u[1],(0,d.useRouter)()),b=(0,c.ZP)(),g=b.setAddressSource,_=b.create_card_form,j=b.is_ship_same_as_bill,w=b.setIsShipSameAsBill,N=b.setCreateCardForm,S=b.clientSecret,C=b.is_pay_disabled,k=b.setIsPayDisabled,P=b.selected_card,O={clientSecret:S,appearance:{theme:"stripe"}};(0,o.useEffect)((function(){L(),B()}),[]),(0,o.useEffect)((function(){L(),B()}),[_]);var A=function(){j?N(x({},_,{bill_name:"",bill_phone:"",bill_postcode:"",bill_city:"",bill_address:"",bill_address_type:""})):(null===_||void 0===_?void 0:_.ship_name)&&(null===_||void 0===_?void 0:_.ship_name.length)>0&&N(x({},_,{bill_name:_.ship_name,bill_phone:_.ship_phone,bill_postcode:_.ship_postcode,bill_city:_.ship_city,bill_address:_.ship_address,bill_address_type:_.ship_address_type})),w(!j)},E=function(){var e,n=(e=r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,localStorage.setItem("create_card_form",JSON.stringify(_));case 2:console.log("create_card_form: ",_),(0,c.sc)(q().total,null,!0);case 4:case"end":return e.stop()}}),e)})),function(){var n=this,t=arguments;return new Promise((function(i,r){var s=e.apply(n,t);function o(e){f(s,i,r,o,l,"next",e)}function l(e){f(s,i,r,o,l,"throw",e)}o(void 0)}))});return function(){return n.apply(this,arguments)}}(),L=function(){_.ship_name&&_.ship_phone&&_.ship_postcode&&_.ship_city&&_.ship_address&&_.ship_address_type&&_.bill_name&&_.bill_phone&&_.bill_postcode&&_.bill_city&&_.bill_address&&_.bill_address_type?k(!1):k(!0)},B=function(){_.ship_name===_.bill_name&&_.ship_phone===_.bill_phone&&_.ship_postcode===_.bill_postcode&&_.ship_city===_.bill_city&&_.ship_address===_.bill_address&&_.ship_address_type===_.bill_address_type&&_.ship_name.length>0&&_.bill_name.length>0?w(!0):w(!1)},q=function(){var e,n,t,i,r=0,s=0;return s+=r+=(null!==(e=null===P||void 0===P?void 0:P.price)&&void 0!==e?e:0)*(null!==(n=null===_||void 0===_?void 0:_.quantity)&&void 0!==n?n:1),s+=(null!==(t=null===_||void 0===_?void 0:_.authority_fee)&&void 0!==t?t:0)+(null!==(i=null===_||void 0===_?void 0:_.shipping_fee)&&void 0!==i?i:0),{sub_total:r,total:s-=null===_||void 0===_?void 0:_.discount}},F=(0,v.$)().t;return(0,s.jsxs)("div",{className:"bg-white md:bg-transparent",children:[(0,s.jsx)("div",{className:"text-center mb-5 mt-10",children:(0,s.jsx)("div",{className:"text-3xl md:text-4xl font-bold text-[#211F32] mb-5",children:F("Checkout")})}),(0,s.jsxs)("div",{className:"grid grid-cols-12 gap-0 md:gap-12 2xl:gap-12 custom-container",children:[(0,s.jsx)("div",{className:"col-span-12 lg:col-span-7",children:(0,s.jsxs)("div",{className:"bg-white py-2 md:py-4 px-4 md:px-10 md:shadow md:rounded-md",children:[(0,s.jsxs)("div",{className:" md:block space-y-5",children:[(0,s.jsx)(a.default,{type:"shipping",onClick:function(){S&&(null===_||void 0===_?void 0:_.ship_name.length)>0||(g({is_from_create:!0,type:"shipping"}),h.push("/profile/address-book"))},address:_.ship_name?{name:_.ship_name,phone:_.ship_phone,postcode:_.ship_postcode,city:_.ship_city,address:_.ship_address,address_type:_.ship_address_type}:null}),(null===_||void 0===_||null===(n=_.ship_name)||void 0===n?void 0:n.length)>0&&(0,s.jsxs)("div",{className:"flex flex-row justify-start space-x-2",children:[(0,s.jsx)("input",{onChange:function(){!S&&A()},checked:j,className:"accent-cBrand",type:"checkbox",value:j}),(0,s.jsx)("div",{className:"cursor-pointer",onClick:function(){!S&&A()},children:F("Billing Address Same as Shipping Address")})]}),(null===_||void 0===_||null===(t=_.ship_name)||void 0===t?void 0:t.length)>0&&!j&&(0,s.jsx)(a.default,{type:"billing",onClick:function(){S&&(null===_||void 0===_?void 0:_.ship_name.length)>0||(g({is_from_create:!0,type:"billing"}),h.push("/profile/address-book"))},address:_.bill_name?{name:_.bill_name,phone:_.bill_phone,postcode:_.bill_postcode,city:_.bill_city,address:_.bill_address,address_type:_.bill_address_type}:null})]}),(0,s.jsxs)("div",{className:"w-full flex flex-row justify-between mt-5",children:[!S&&(0,s.jsx)("button",{onClick:function(){return c.ZP.getState().setCurrState("choose_frame")},className:"mx-auto mb-5 px-20 py-2 bg-white hover:bg-gray-600 text-gray-600 hover:text-white transition-all ease-in rounded-md font-bold shadow",children:F("Back")}),!S&&(0,s.jsx)("button",{onClick:function(){return E()},disabled:C,className:"mx-auto mb-5 px-20 md:px-12 py-2 ".concat(C?"bg-cPlaceholder cursor-not-allowed":"bg-cBrand"," text-white transition-all ease-in rounded-md font-bold shadow"),children:F("Pay Now")}),S&&(null===_||void 0===_?void 0:_.ship_name.length)>0&&(null===_||void 0===_?void 0:_.bill_name.length)>0&&(0,s.jsx)(m.Elements,{options:O,stripe:y,children:(0,s.jsx)(p.default,{})})]})]})}),(0,s.jsx)("div",{className:"col-span-12 lg:col-span-5",children:(0,s.jsx)("div",{className:"bg-white py-2 md:py-4 px-4 md:px-10 md:shadow md:rounded-md",children:(0,s.jsx)(l.default,{changeState:i})})})]})]})}},34036:function(e,n,t){t.r(n);var i=t(85893),r=t(25675),s=t.n(r),o=t(67294),l=t(31567),a=t(8193),d=t(74995),c=t(99799),u=t(30622),m=t(37677);function p(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function h(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},i=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),i.forEach((function(n){p(e,n,t[n])}))}return e}n.default=function(e){e.changeState;var n=(0,d.ZP)(),t=n.selected_card,r=n.create_card_form,p=n.setCreateCardForm,v=n.voucher_info,f=n.setVoucherInfo,b=n.voucher,x=n.setVoucher,y=function(){var e,n,i,s,o=0,l=0;return l+=o+=(null!==(e=null===t||void 0===t?void 0:t.price)&&void 0!==e?e:0)*(null!==(n=null===r||void 0===r?void 0:r.quantity)&&void 0!==n?n:1),l+=(null!==(i=null===r||void 0===r?void 0:r.authority_fee)&&void 0!==i?i:0)+(null!==(s=null===r||void 0===r?void 0:r.shipping_fee)&&void 0!==s?s:0),{sub_total:o,total:l-=null===r||void 0===r?void 0:r.discount}},g=function(e){if(1!==(null===r||void 0===r?void 0:r.quantity)||"minus"!==e){var n;console.log("changeCardQuantity",e,t);var t=null!==(n=null===r||void 0===r?void 0:r.quantity)&&void 0!==n?n:1;"plus"===e?t+=1:t-=1,p(h({},r,{quantity:t}))}};(0,o.useEffect)((function(){var e=JSON.parse(localStorage.getItem("general_info"));p(h({},r,{authority_fee:null===e||void 0===e?void 0:e.authority_fee,shipping_fee:null===e||void 0===e?void 0:e.shipping_fee}))}),[]);var _,j,w,N,S=(0,l.$)().t;return(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"text-xl md:text-lg font-semibold mb-5",children:S("Order Summary")}),(0,i.jsx)("div",{className:"relative h-72 md:h-48 w-full mb-2",children:(0,i.jsx)("div",{className:"h-full w-full relative rounded-lg overflow-hidden",children:(0,i.jsx)(s(),{className:"h-auto",src:(null===t||void 0===t?void 0:t.image)&&(null===r||void 0===r?void 0:r.card_id)?c.xw+(null===t||void 0===t?void 0:t.image):m.ST,alt:"Post Card Image",layout:"fill",objectFit:"cover"})})}),(0,i.jsxs)("div",{className:"flex items-center justify-between mb-5",children:[(0,i.jsx)("div",{className:"font-semibold",children:S("Postcard")}),(0,i.jsxs)("div",{className:"flex justify-between items-center rounded-md text-2xl mx-2 mb-2 select-none",children:[(0,i.jsx)(a.ywL,{onClick:function(){return g("minus")},className:"cp p-2 m-1 bg-gray-100 hover:bg-gray-300 transition-all ease-in-out rounded-md text-3xl"}),(0,i.jsx)("div",{className:"mx-2 text-base",children:null!==(_=null===r||void 0===r?void 0:r.quantity)&&void 0!==_?_:1}),(0,i.jsx)(a.Lfi,{onClick:function(){return g("plus")},className:"cp p-2 m-1 bg-gray-100 hover:bg-gray-300 transition-all ease-in-out rounded-md text-3xl"})]})]}),v?(0,i.jsxs)("div",{className:"bg-cBrickHover w-full flex justify-center items-center py-2 mb-5 border-dashed border relative",children:[S("Voucher")," ",null===v||void 0===v?void 0:v.code,(0,i.jsx)("div",{className:"absolute right-1 top-1 cursor-pointer",onClick:function(){f(null),p(h({},r,{discount:0,discount_code:""}))},children:(0,i.jsx)(a.LHV,{})})]}):(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-2 md:gap-10 mb-5 w-full ",children:[(0,i.jsx)(u.Z,{onChange:function(e){return x(e.target.value)},className:"col-span-2",name:"discount_code",value:b,no_label:!0,placeholder:S("Gift Card/Discount Code")}),(0,i.jsx)("button",{onClick:function(){return(0,d.oT)(b)},className:"border border-gray-600 bg-white hover:bg-gray-600 text-gray-600 hover:text-white transition-all ease-in rounded-md text-sm font-medium focus:outline-none",children:S("Apply")})]}),(0,i.jsxs)("div",{className:"mb-5",children:[(0,i.jsxs)("div",{className:"border-b",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,i.jsx)("div",{className:"text-gray-600",children:S("Sub Total")}),(0,i.jsxs)("div",{className:"text-gray-600",children:["\xa5",y().sub_total]})]}),(0,i.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,i.jsx)("div",{className:"text-gray-600",children:S("Authority Fee")}),(0,i.jsxs)("div",{className:"text-gray-600",children:["\xa5",null!==(j=null===r||void 0===r?void 0:r.authority_fee)&&void 0!==j?j:0]})]}),(0,i.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,i.jsx)("div",{className:"text-gray-600",children:S("Shipping")}),(0,i.jsxs)("div",{className:"text-gray-600",children:["\xa5",null!==(w=r.shipping_fee)&&void 0!==w?w:0]})]}),v&&(0,i.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,i.jsx)("div",{className:"text-gray-600",children:S("Applied Voucher")}),(0,i.jsxs)("div",{className:"text-gray-600",children:["\xa5",null!==(N=null===v||void 0===v?void 0:v.amount)&&void 0!==N?N:0]})]})]}),(0,i.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,i.jsx)("div",{className:"text-gray-700 font-bold",children:S("Total")}),(0,i.jsxs)("div",{className:"text-gray-700 font-semibold",children:["\xa5",y().total]})]})]})]})}},35832:function(e,n,t){t.r(n),t.d(n,{default:function(){return o}});var i=t(85893),r=(t(67294),t(31567)),s=t(51649);function o(e){var n=e.type,t=void 0===n?"billing":n,o=e.address,l=void 0===o?null:o,a=e.onClick,d=(0,r.$)().t;return(0,i.jsxs)("div",{onClick:a,className:"border rounded-md flex flex-row justify-between items-center px-2 py-3 cursor-pointer",children:[(0,i.jsx)("div",{children:l?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("strong",{children:d("billing"===t?"Billing Address":"Shipping Address")}),(0,i.jsx)("div",{children:null===l||void 0===l?void 0:l.name}),(0,i.jsx)("div",{children:null===l||void 0===l?void 0:l.phone}),(0,i.jsx)("div",{children:null===l||void 0===l?void 0:l.address})]}):d("billing"===t?"Select Billing Address":"Select Shipping Address")}),(0,i.jsx)(s.hjJ,{})]})}},83782:function(e,n,t){t.r(n),t.d(n,{default:function(){return v}});var i=t(34051),r=t.n(i),s=t(85893),o=t(67294),l=t(86664),a=t(11163),d=t(74995),c=t(31567),u=t(63750);function m(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}function p(e,n,t,i,r,s,o){try{var l=e[s](o),a=l.value}catch(d){return void t(d)}l.done?n(a):Promise.resolve(a).then(i,r)}function h(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var i,r,s=[],o=!0,l=!1;try{for(t=t.call(e);!(o=(i=t.next()).done)&&(s.push(i.value),!n||s.length!==n);o=!0);}catch(a){l=!0,r=a}finally{try{o||null==t.return||t.return()}finally{if(l)throw r}}return s}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return m(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return m(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(){var e=(0,l.useStripe)(),n=(0,l.useElements)(),t=h(o.useState(null),2),i=t[0],m=t[1],v=h(o.useState(!1),2),f=v[0],b=v[1],x=(0,a.useRouter)().pathname;o.useEffect((function(){if(e){var n=new URLSearchParams(window.location.search).get("payment_intent_client_secret");n&&e.retrievePaymentIntent(n).then((function(e){var n=e.paymentIntent;switch(n.status){case"succeeded":m("Payment succeeded!"),console.log("paymentIntent: ",n);break;case"processing":m("Your payment is processing.");break;case"requires_payment_method":m("Your payment was not successful, please try again.");break;default:m("Something went wrong.")}}))}}),[e]);var y=window.location.origin?window.location.origin:"",g=function(){var t,i=(t=r().mark((function t(i){var s,o;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i.preventDefault(),e&&n){t.next=3;break}return t.abrupt("return");case 3:return b(!0),t.next=6,e.confirmPayment({elements:n,confirmParams:{return_url:"/profile/order-history"==x?y+"/create/DuePaymentConfirmation":y+"/create/PaymentConfirmation"}});case 6:s=t.sent,console.log("payment result",s),"card_error"===(null===(o=s.error)||void 0===o?void 0:o.type)||"validation_error"===(null===o||void 0===o?void 0:o.type)?m(o.message):(console.log("error",o),m("An unexpected error occurred.")),b(!1);case 11:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(i,r){var s=t.apply(e,n);function o(e){p(s,i,r,o,l,"next",e)}function l(e){p(s,i,r,o,l,"throw",e)}o(void 0)}))});return function(e){return i.apply(this,arguments)}}(),_=(0,c.$)().t;return(0,s.jsxs)("form",{className:"w-full",id:"payment-form",onSubmit:g,children:[(0,s.jsx)(l.PaymentElement,{id:"payment-element",options:{layout:"tabs"}}),(0,s.jsxs)("div",{className:"flex flex-row justify-start space-x-2 mb-5 items-center",children:[(0,s.jsx)(u.FPm,{}),(0,s.jsx)("div",{className:"text-cBrand text-fs14",children:"No card info will be saved"})]}),(0,s.jsxs)("div",{className:"flex flex-row ".concat("/profile/order-history"==x?"justify-center":"justify-between"," space-x-0"),children:["/profile/order-history"!=x&&(0,s.jsx)("button",{onClick:function(){return d.ZP.getState().setCurrState("choose_frame")},className:" px-12 py-2 bg-white hover:bg-gray-600 text-gray-600 hover:text-white transition-all ease-in rounded-md text-sm md:text-base font-bold shadow",children:_("Back")}),(0,s.jsx)("button",{className:"bg-cBrand text-cWhite rounded-br5 border-0 px-3 py-2 cursor-pointer font-fw600 block w-auto hover:contrast-125 disabled:opacity-50 disabled:cursor-default shadow-md",disabled:f||!e||!n,id:"submit",children:(0,s.jsx)("span",{id:"button-text",children:f?(0,s.jsx)("div",{className:"spinner",id:"spinner"}):_("Confirm Payment")})})]}),i&&(0,s.jsx)("div",{id:"payment-message",children:i})]})}}}]);